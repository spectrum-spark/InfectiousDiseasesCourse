<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Introduction to modelling vector-borne disease models">

<title>Building vector-borne disease models – Modelling Infectious Diseases</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4c864af37f48f2a1899c864f22be1eba.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../site_libs/quarto-contrib/quarto-project/spectrum-spark/training/style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../session7_vector_borne_modelling/session7_vector_borne_modelling.html">Building vector-borne disease models</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Modelling Infectious Diseases</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1_intro_to_mathematical_modelling/session1_intro_to_mathematical_modelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Mathematical Modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2_differential_equations_in_r/session2_differential_equations_in_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential Equations in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3_writing_a_model_to_suit_the_infectious_agent/session3_writing_a_model_to_suit_the_infectious_agent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Designing a model to suit the pathogen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4_covid_thailand_seir_model/session4_covid_thailand_seir_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelling an outbreak - COVID-19 in Thailand</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session5_fitting_models_in_r/session5_fitting_models_in_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fitting Models in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session7_vector_borne_modelling/session7_vector_borne_modelling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Building vector-borne disease models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session8_vector_borne_modelling_in_r/session8_vector_borne_modelling_in_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector-borne disease models in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session9_modelling_interventions_in_r/session9_modelling_interventions_in_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelling interventions in R</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#part-1-motivation-and-examples" id="toc-part-1-motivation-and-examples" class="nav-link" data-scroll-target="#part-1-motivation-and-examples"><strong>Part 1:</strong> Motivation and examples</a>
  <ul class="collapse">
  <li><a href="#what-are-vector-borne-diseases" id="toc-what-are-vector-borne-diseases" class="nav-link" data-scroll-target="#what-are-vector-borne-diseases">What are vector-borne diseases?</a></li>
  <li><a href="#examples-of-vector-borne-diseases-and-vectors-that-spread-them" id="toc-examples-of-vector-borne-diseases-and-vectors-that-spread-them" class="nav-link" data-scroll-target="#examples-of-vector-borne-diseases-and-vectors-that-spread-them">Examples of vector-borne diseases and vectors that spread them</a></li>
  <li><a href="#how-do-vector-borne-diseases-spread" id="toc-how-do-vector-borne-diseases-spread" class="nav-link" data-scroll-target="#how-do-vector-borne-diseases-spread">How do vector-borne diseases spread?</a></li>
  <li><a href="#burden-of-disease" id="toc-burden-of-disease" class="nav-link" data-scroll-target="#burden-of-disease">Burden of disease</a></li>
  <li><a href="#how-can-modelling-help" id="toc-how-can-modelling-help" class="nav-link" data-scroll-target="#how-can-modelling-help">How can modelling help?</a></li>
  </ul></li>
  <li><a href="#part-1-solutions" id="toc-part-1-solutions" class="nav-link" data-scroll-target="#part-1-solutions"><strong>Part 1:</strong> Solutions</a></li>
  <li><a href="#part-2-elements-of-vector-borne-disease-models" id="toc-part-2-elements-of-vector-borne-disease-models" class="nav-link" data-scroll-target="#part-2-elements-of-vector-borne-disease-models"><strong>Part 2:</strong> Elements of vector-borne disease models</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#simplified-spread-of-a-mosquito-borne-disease" id="toc-simplified-spread-of-a-mosquito-borne-disease" class="nav-link" data-scroll-target="#simplified-spread-of-a-mosquito-borne-disease">Simplified spread of a mosquito-borne disease</a></li>
  <li><a href="#recovery-from-infection" id="toc-recovery-from-infection" class="nav-link" data-scroll-target="#recovery-from-infection">Recovery from infection</a></li>
  <li><a href="#human-and-mosquito-populations-interact-through-bites" id="toc-human-and-mosquito-populations-interact-through-bites" class="nav-link" data-scroll-target="#human-and-mosquito-populations-interact-through-bites">Human and mosquito populations interact through <span style="color: red">bites</span></a></li>
  <li><a href="#probability-of-successful-transmission" id="toc-probability-of-successful-transmission" class="nav-link" data-scroll-target="#probability-of-successful-transmission">Probability of successful transmission</a></li>
  <li><a href="#force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m" id="toc-force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m" class="nav-link" data-scroll-target="#force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m">Force of infection on humans <span class="math inline">\((λ_H)\)</span> and on mosquitoes <span class="math inline">\((λ_M)\)</span></a></li>
  <li><a href="#new-infections-per-unit-time" id="toc-new-infections-per-unit-time" class="nav-link" data-scroll-target="#new-infections-per-unit-time">New infections per unit time</a></li>
  <li><a href="#births-and-deaths" id="toc-births-and-deaths" class="nav-link" data-scroll-target="#births-and-deaths">Births and deaths</a></li>
  <li><a href="#other-modelling-considerations" id="toc-other-modelling-considerations" class="nav-link" data-scroll-target="#other-modelling-considerations">Other modelling considerations</a></li>
  </ul></li>
  <li><a href="#part-2-solutions" id="toc-part-2-solutions" class="nav-link" data-scroll-target="#part-2-solutions"><strong>Part 2:</strong> Solutions</a></li>
  <li><a href="#part-3-writing-the-model" id="toc-part-3-writing-the-model" class="nav-link" data-scroll-target="#part-3-writing-the-model"><strong>Part 3:</strong> Writing the model</a>
  <ul class="collapse">
  <li><a href="#model-diagram" id="toc-model-diagram" class="nav-link" data-scroll-target="#model-diagram">Model Diagram</a></li>
  <li><a href="#upload-your-image" id="toc-upload-your-image" class="nav-link" data-scroll-target="#upload-your-image">Upload your image</a></li>
  <li><a href="#alternatively-describe-your-model-structure-here" id="toc-alternatively-describe-your-model-structure-here" class="nav-link" data-scroll-target="#alternatively-describe-your-model-structure-here">Alternatively, describe your model structure here</a></li>
  <li><a href="#model-equations" id="toc-model-equations" class="nav-link" data-scroll-target="#model-equations">Model equations</a></li>
  <li><a href="#basic-reproduction-number" id="toc-basic-reproduction-number" class="nav-link" data-scroll-target="#basic-reproduction-number">Basic reproduction number</a></li>
  </ul></li>
  <li><a href="#part-3-solutions" id="toc-part-3-solutions" class="nav-link" data-scroll-target="#part-3-solutions"><strong>Part 3:</strong> Solutions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><h1 class="title display-7">Building vector-borne disease models</h1></header>

<header id="title-block-header">

<p class="subtitle lead">SPARKLE short course ‘Mathematical Modelling of Infectious Diseases’</p>

</header>


<p class="presenter">
  <span class="emph">Presenter:</span> Trish Campbell, The University of Melbourne at The Peter Doherty Institute for Infection and Immunity
</p>

<section id="summary" class="level1 tabset tabset-pills tabset-fade">
<h1 class="tabset tabset-pills tabset-fade">Summary</h1>
<p>This is an interactive session to introduce the concepts of modelling vector-borne diseases. The motivation for modelling and differences compared to modelling diseases spread by direct transmission will be covered. We will write down a basic model and derive the expression for <span class="math inline">\(\mathcal{R}_0\)</span>.</p>
<p>This session is divided into three parts:</p>
<p><strong>Part 1</strong> covers:</p>
<ul>
<li>Motivation for vector-borne disease models</li>
<li>Examples of vector-borne diseases</li>
<li>Different transmission cycles</li>
</ul>
<p><strong>Part 2</strong> covers:</p>
<ul>
<li>The mechanics of vector-borne disease transmission</li>
<li>Force of infection for vector-borne diseases</li>
<li>Other vector-borne disease modelling considerations</li>
</ul>
<p><strong>Part 3</strong> covers:</p>
<ul>
<li>Drawing a model schematic</li>
<li>Writing the differential equations</li>
<li>Calculating the basic reproduction number</li>
</ul>
<p><em>We recommend saving your text at the end of each part by printing the file.</em></p>
<section id="part-1-motivation-and-examples" class="level2">
<h2 class="anchored" data-anchor-id="part-1-motivation-and-examples"><strong>Part 1:</strong> Motivation and examples</h2>
<section id="what-are-vector-borne-diseases" class="level3">
<h3 class="anchored" data-anchor-id="what-are-vector-borne-diseases">What are vector-borne diseases?</h3>
<p>Unlike diseases that spread directly from person to person, vector-borne diseases are those diseases in which the spread of an infectious pathogen occurs via a vector — a living organism that is typically a bloodsucking insect, such as a mosquito. Once a vector becomes infectious, they typically remain so for the rest of their life. They also are typically not adversely affected by the infection. Examples of vectors include (left to right) mosquitoes, ticks, blackflies and fleas:</p>
<div class="row">
<p><img src="mosquito.jpg" alt="Mosquito biting" style="width:25%"> <img src="tick.jpg" alt="Tick" style="width:25.6%"> <img src="Simulium_Blackfly.jpg" alt="Blackfly" style="width:21.4%"> <img src="flea.jpg" alt="Flea" style="width:12%"></p>
</div>
</section>
<section id="examples-of-vector-borne-diseases-and-vectors-that-spread-them" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-vector-borne-diseases-and-vectors-that-spread-them">Examples of vector-borne diseases and vectors that spread them</h3>
<p>There are many different types of vector. While some diseases, such as malaria, are exclusively spread by a single vector genus, others, such as lymphatic filariasis, can be transmitted by multiple species. Similarly, some vectors are able to spread multiple diseases.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Vector</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Disease</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mosquito - Anopheles</td>
<td style="text-align: left;">Malaria, Lymphatic filariasis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mosquito - Aedes</td>
<td style="text-align: left;">Zika, Dengue, Lymphatic filariasis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mosquito - Culex</td>
<td style="text-align: left;">West Nile fever, Japanese encephalitis, Lymphatic filariasis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Blackflies</td>
<td style="text-align: left;">Onchocerciasis</td>
</tr>
</tbody>
</table>
</div>
</div>
<!-- todo: perhaps add some more non-mosquito examples relevant to Indonesia here -->
<p>Source: <a href="https://www.who.int/news-room/fact-sheets/detail/vector-borne-diseases"> https://www.who.int/news-room/fact-sheets/detail/vector-borne-diseases </a></p>
<p>
</p>
<p><strong>1.1 Do you know which of these vector-borne diseases is relevant to your region? Are there any others?</strong></p>
<textarea cols="127" rows="3"></textarea>
<p>
<br>
</p>
</section>
<section id="how-do-vector-borne-diseases-spread" class="level3">
<h3 class="anchored" data-anchor-id="how-do-vector-borne-diseases-spread">How do vector-borne diseases spread?</h3>
<p>Below are diagrams showing the transmission cycles for two vector-borne diseases: Onchocerciasis (top) and West Nile fever, caused by infection with West Nile virus (bottom).</p>
<p>
</p>
<div class="row">
<center>
<img src="onchocerciasis.tif" alt="Onchocerciasis transmission cycle" style="width:80%">
</center>
</div>
<!-- todo: consider changing oncho to something more relevant. Could be malaria or dengue. Change WNV to JEV. Propogate the changes through to the questions below. -->
<center>
Source: <a href="https://www.cdc.gov/dpdx/onchocerciasis/index.html"> https://www.cdc.gov/dpdx/onchocerciasis/index.html</a>
</center>
<p>
<br><br>
</p>
<div class="row">
<center>
<img src="west_nile.jpg" alt="West Nile fever transmission cycle" style="width:80%">
</center>
</div>
<center>
Source: <a href="https://www.cdc.gov/westnile/transmission/index.html"> https://www.cdc.gov/westnile/transmission/index.html </a>
</center>
<p>
<br>
</p>
<p><strong>1.2 What type of vector is responsible for the spread of onchocerciasis?</strong></p>
<textarea cols="127" rows="3"></textarea>
<p>
<br>
</p>
<p><strong>1.3 What type of vector is responsible for the spread of West Nile virus?</strong></p>
<textarea cols="127" rows="3"></textarea>
<p>
<br>
</p>
<p><strong>1.4 What is the main difference you notice between these two transmission cycles?</strong></p>
<textarea cols="127" rows="3"></textarea>
<p>
<br>
</p>
<p>We can divide vector-borne diseases into two categories, those that spread by a human-vector-human cycle (e.g.&nbsp;malaria, dengue, zika, onchocerciasis) and those that involve a non-human host (e.g.&nbsp;West Nile virus, Japanese encephalitis). In this session, we will only be working with diseases that spread by a human-vector-human cycle.</p>
</section>
<section id="burden-of-disease" class="level3">
<h3 class="anchored" data-anchor-id="burden-of-disease">Burden of disease</h3>
<p>Diseases spread by vectors account for almost one-fifth of all infectious diseases and are responsible for more than 700,000 deaths annually. Much of this disease burden is due to malaria and dengue infections, estimated to cause more than 440,000 deaths per year. The map below displays the distribution of deaths due to vector-borne diseases, estimated by the World Health Organization in 2002. While Africa has the highest burden, there is substantial burden in the Asia Pacific region. As global temperatures increase, the global distribution of vectors is changing, which may allow the spread of vector-borne diseases into new areas.</p>
<p>
<img src="vector_borne_deaths.jpg" width="80%">
</p>
<p>Source: <a href="https://doi.org/10.1016/B978-0-12-384890-1.00015-7"> https://doi.org/10.1016/B978-0-12-384890-1.00015-7 </a></p>
</section>
<section id="how-can-modelling-help" class="level3">
<h3 class="anchored" data-anchor-id="how-can-modelling-help">How can modelling help?</h3>
<p><strong>1.5 What are some ways that modelling might be used to help reduce the burden of vector-borne infectious diseases?</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p>
<input type="button" value="Print this page" onclick="window.print()">
</p>
</section>
</section>
<section id="part-1-solutions" class="level2">
<h2 class="anchored" data-anchor-id="part-1-solutions"><strong>Part 1:</strong> Solutions</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><strong>Part 1:</strong> Spoiler alert</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><strong>Part 1:</strong> Solutions for Part 1</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The solutions tab contains suggested answers for Part 1. <strong>Only click on it if you have tried to complete the exercises yourself and need some help</strong></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<!-- todo: if you update the above in any way, remember to change this section too. -->
<section id="what-are-vector-borne-diseases-1" class="level3">
<h3 class="anchored" data-anchor-id="what-are-vector-borne-diseases-1">What are vector-borne diseases?</h3>
<p>Unlike diseases that spread directly from person to person, vector-borne diseases are those diseases in which the spread of an infectious pathogen occurs via a vector — a living organism such as a mosquito. Examples of vectors include (left to right) mosquitoes, ticks, blackflies and fleas:</p>
<div class="row">
<p><img src="mosquito.jpg" alt="Mosquito biting" style="width:25%"> <img src="tick.jpg" alt="Tick" style="width:25.6%"> <img src="Simulium_Blackfly.jpg" alt="Blackfly" style="width:21.4%"> <img src="flea.jpg" alt="Flea" style="width:12%"></p>
</div>
</section>
<section id="examples-of-vector-borne-diseases-and-vectors-that-spread-them-1" class="level3">
<h3 class="anchored" data-anchor-id="examples-of-vector-borne-diseases-and-vectors-that-spread-them-1">Examples of vector-borne diseases and vectors that spread them</h3>
<p>There are many different types of vector. While some diseases, such as malaria, are exclusively spread by a single vector genus, others, such as lymphatic filariasis, can be transmitted by multiple species. Similarly, some vectors are able to spread multiple diseases.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Vector</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Disease</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mosquito - Anopheles</td>
<td style="text-align: left;">Malaria, Lymphatic filariasis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mosquito - Aedes</td>
<td style="text-align: left;">Zika, Dengue, Lymphatic filariasis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mosquito - Culex</td>
<td style="text-align: left;">West Nile fever, Japanese encephalitis, Lymphatic filariasis</td>
</tr>
<tr class="even">
<td style="text-align: left;">Blackflies</td>
<td style="text-align: left;">Onchocerciasis</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Source: <a href="https://www.who.int/news-room/fact-sheets/detail/vector-borne-diseases"> https://www.who.int/news-room/fact-sheets/detail/vector-borne-diseases </a></p>
<p>
</p>
<p><strong>1.1 Do you know which of these vector-borne diseases is important to your country? Are there any others?</strong></p>
<p><span style="color: blue">Others might include leishmaniasis, ricksettial diseases</span></p>
<p>
<br>
</p>
</section>
<section id="how-do-vector-borne-diseases-spread-1" class="level3">
<h3 class="anchored" data-anchor-id="how-do-vector-borne-diseases-spread-1">How do vector-borne diseases spread?</h3>
<p>Below are diagrams showing the transmission cycles for two vector-borne diseases: Onchocerciasis (top) and West Nile fever, caused by infection with West Nile virus (bottom).</p>
<p>
</p>
<div class="row">
<center>
<img src="onchocerciasis.tif" alt="Onchocerciasis transmission cycle" style="width:80%">
</center>
</div>
<center>
Source: <a href="https://www.cdc.gov/dpdx/onchocerciasis/index.html"> https://www.cdc.gov/dpdx/onchocerciasis/index.html</a>
</center>
<p>
<br><br>
</p>
<div class="row">
<center>
<img src="west_nile.jpg" alt="West Nile fever transmission cycle" style="width:80%">
</center>
</div>
<center>
Source: <a href="https://www.cdc.gov/westnile/transmission/index.html"> https://www.cdc.gov/westnile/transmission/index.html </a>
</center>
<p>
<br>
</p>
<p><strong>1.2 What type of vector is responsible for the spread of onchocerciasis?</strong></p>
<p><span style="color: blue">Blackfly</span></p>
<p>
<br>
</p>
<p><strong>1.3 What type of vector is responsible for the spread of West Nile virus?</strong></p>
<p><span style="color: blue">Mosquito</span></p>
<p>
<br>
</p>
<p><strong>1.4 What is the main difference you notice between these two transmission cycles?</strong></p>
<p><span style="color: blue">WNV includes non-human hosts</span></p>
<p>
<br>
</p>
<p>We can divide vector-borne diseases into two categories, those that spread by a human-vector-human cycle (e.g.&nbsp;malaria, dengue, zika, onchocerciasis) and those that involve a non-human host (e.g.&nbsp;West Nile virus, Japanese encephalitis). In this session, we will only be working with diseases that spread by a human-vector-human cycle.</p>
</section>
<section id="burden-of-disease-1" class="level3">
<h3 class="anchored" data-anchor-id="burden-of-disease-1">Burden of disease</h3>
Diseases spread by vectors account for almost one-fifth of all infectious diseases and are responsible for more than 700,000 deaths annually. Much of this disease burden is due to malaria and dengue infections, estimated to cause more than 440,000 deaths per year. The map below displays the distribution of deaths due to vector-borne diseases, estimated by the World Health Organization in 2002. While Africa has the highest burden, there is substantial burden in the Asia Pacific region. As global temperatures increase, the global distribution of vectors is changing, which may allow the spread of vector-borne diseases into new areas. <!-- todo: update the above suggested answer to foreshadow discussions for tomorrow's session -->
<p>
<img src="vector_borne_deaths.jpg" width="80%">
</p>
<p>Source: <a href="https://doi.org/10.1016/B978-0-12-384890-1.00015-7"> https://doi.org/10.1016/B978-0-12-384890-1.00015-7 </a></p>
</section>
<section id="how-can-modelling-help-1" class="level3">
<h3 class="anchored" data-anchor-id="how-can-modelling-help-1">How can modelling help?</h3>
<p><strong>1.5 What are some ways that modelling might be used to help reduce the burden of vector-borne infectious diseases?</strong></p>
<p><span style="color: blue">Forecast likely cases in order to scale up necessary treatments; help understand the factors that are important to spread; investigate the types of interventions that might help to control transmission; inform decisions of policy-makers</span></p>
<p>
<br>
</p>
<p>
<input type="button" value="Print this page" onclick="window.print()">
</p>
</section>
</div>
</div>
</div>
</section>
<section id="part-2-elements-of-vector-borne-disease-models" class="level2">
<h2 class="anchored" data-anchor-id="part-2-elements-of-vector-borne-disease-models"><strong>Part 2:</strong> Elements of vector-borne disease models</h2>
<section id="purpose" class="level3">
<h3 class="anchored" data-anchor-id="purpose">Purpose</h3>
<p>In this part of the session, we will consider the mechanistic process by which vector-borne diseases spread and consider the other elements that are needed in vector-borne disease models.</p>
</section>
<section id="simplified-spread-of-a-mosquito-borne-disease" class="level3">
<h3 class="anchored" data-anchor-id="simplified-spread-of-a-mosquito-borne-disease">Simplified spread of a mosquito-borne disease</h3>
<!-- todo: consider changing "vector" to "mosquito" throughout this section and the next for consistency -->
<p>While there are many different types of vectors, in this and the following part we will cover modelling of diseases that are spread by mosquitoes. Female mosquitoes bite humans to obtain protein from blood for their developing eggs. These bites can transmit infection from mosquito to human or from human to mosquito. The following diagram outlines a simple transmission cycle of a mosquito-borne disease:</p>
<div class="row">
<center>
<img src="vector_borne_cycle_simple.png" alt="Simplified spread of a mosquito-borne disease" style="width:50%">
</center>
</div>
<p>
<br>
</p>
<p>The steps involved in transmission, as indicated on the diagram above are:</p>
<ol type="1">
<li>A susceptible mosquito bites an infectious human.</li>
<li>Infection is successfully transmitted to the mosquito. The pathogen multiplies within the mosquito. The mosquito is now infectious, and capable of transmitting disease.</li>
<li>The infectious mosquito bites a susceptible human.</li>
<li>Infection is successfully transmitted to the human. The pathogen multiplies within the human. The human is now infectious, and capable of transmitting disease.</li>
</ol>
<p>You might notice that in our diagram above both humans and mosquitoes are infectious immediately upon being infected. In reality, it takes time for the infectious load to build in a host before they are capable of transmitting infection. We make this assumption here to simplify the explanation of the transmission process.</p>
</section>
<section id="recovery-from-infection" class="level3">
<h3 class="anchored" data-anchor-id="recovery-from-infection">Recovery from infection</h3>
<p>For the model that we are building in this session, we will assume that:</p>
<ul>
<li>Infectious humans recover at a rate that is the reciprocal of their infectious period.</li>
<li>Once an infectious human recovers, they are immune for the remainder of their life.</li>
<li>Mosquitoes, once infected, remain infectious for the rest of their life.</li>
</ul>
<p>
<br>
</p>
<p><strong>2.1 Based on the diagram and assumptions above, what compartments would be required to model the human population? Use the subscript H to indicate that these are human compartments.</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p><strong>2.2 Based on the diagram and assumptions above, what compartments would be required to model the mosquito population? Use the subscript M to indicate that these are mosquito compartments.</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
</section>
<section id="human-and-mosquito-populations-interact-through-bites" class="level3">
<h3 class="anchored" data-anchor-id="human-and-mosquito-populations-interact-through-bites">Human and mosquito populations interact through <span style="color: red">bites</span></h3>
<p>The feature that makes vector-borne disease models different to models for diseases spread by direct contact is that the human and mosquito populations interact through bites. Note only adult female mosquitoes bite. We start with the assumption that each mosquito makes a fixed number of bites per unit time, and we define this as <span class="math inline">\(b\)</span>. We further assume that those bites are uniformly spread across the human population, <span class="math inline">\(N_H\)</span>. It follows that the rate at which a specific human is bitten by a specific mosquito, which we define as <span class="math inline">\(r\)</span>, can be calculated as:</p>
<p><span class="math display">\[r=\frac{b}{N_H}\]</span></p>
<p>This is the number of bites a single human receives from a single mosquito per unit time, and is analogous to ‘contact’ in directly-transmitted disease models. <!-- fixme: this contact rate has not yet been explained, so needs to be here. I.e. that transmision rate = contact rate times probability of infection given that contact occurs --></p>
<p><strong>2.3 What happens to the rate <span class="math inline">\(r\)</span> as the human population increases? What do you think might be the implication for transmission?</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
</section>
<section id="probability-of-successful-transmission" class="level3">
<h3 class="anchored" data-anchor-id="probability-of-successful-transmission">Probability of successful transmission</h3>
<p>Similar to contacts in the case of directly transmitted (human to human) infections, not all mosquito bites will be of sufficient intensity to transmit infection. For each bite, we assign a probability that the bite is of sufficient intensity to transmit infection (if one host is susceptible and the other infectious), using the following notation:</p>
<ul>
<li><span class="math inline">\(T_{HM}\)</span> is the probability that an infectious mosquito biting a human transmits infection to the human</li>
<li><span class="math inline">\(T_{MH}\)</span> is the probability that an infectious human being bitten by a susceptible mosquito transmits infection to the mosquito</li>
</ul>
<p>We refer to this as the probability of successful transmission.</p>
<p><strong>2.4 Write the expression for the number of bites a single human receives from a single mosquito per unit time that are capable of transmitting infection from mosquito to human.</strong></p>
<!-- todo: in the solutions, explain in words before writing down the equation -->
<textarea cols="127" rows="2"></textarea>
<p>
<br>
</p>
<p><strong>2.5 Write the expression for the number of bites a single human receives from a single mosquito per unit time that are capable of transmitting infection from human to mosquito.</strong></p>
<textarea cols="127" rows="2"></textarea>
<p>
<br>
</p>
</section>
<section id="force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m" class="level3">
<h3 class="anchored" data-anchor-id="force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m">Force of infection on humans <span class="math inline">\((λ_H)\)</span> and on mosquitoes <span class="math inline">\((λ_M)\)</span></h3>
<p>The expressions in 2.4 and 2.5 are for the rate of ‘successful’ bites between a single susceptible human and a single infectious mosquito. The <em>force of infection on humans</em>, <span class="math inline">\(λ_H\)</span>, is the rate at which a susceptible human acquires infection, noting that infection can be acquired from any infectious mosquito.</p>
<p><strong>2.6 Write the expression for the force of infection on humans,</strong> <span class="math inline">\(λ_H\)</span>.</p>
<textarea cols="127" rows="2"></textarea>
<p>
<br>
</p>
<p>Similarly the <em>force of infection on mosquitoes</em>, <span class="math inline">\(λ_M\)</span>, is the rate at which a susceptible mosquito acquires infection. A mosquito can acquire infection from any infectious human.</p>
<p><strong>2.7 Write the expression for the force of infection on mosquitoes,</strong> <span class="math inline">\(λ_M\)</span>.</p>
<textarea cols="127" rows="2"></textarea>
<p>
<br>
</p>
</section>
<section id="new-infections-per-unit-time" class="level3">
<h3 class="anchored" data-anchor-id="new-infections-per-unit-time">New infections per unit time</h3>
<p>The force of infection (on humans or mosquitoes) is the rate at which infection is acquired in a single susceptible host. To calculate the rate that new infections occur in the whole human or mosquito population, we have to multiply the force of infection by the population at risk of being infected.</p>
<p><strong>2.8 Using the equation for the force of infection on humans, <span class="math inline">\(λ_H\)</span>, write the expression for the total number of human infections per unit time.</strong></p>
<textarea cols="127" rows="2"></textarea>
<p>
<br>
</p>
<p><strong>2.9 Using the equation for the force of infection on mosquitoes, <span class="math inline">\(λ_M\)</span>, write the expression for the total number of mosquito infections per unit time.</strong></p>
<textarea cols="127" rows="2"></textarea>
<p>
<br>
</p>
</section>
<section id="births-and-deaths" class="level3">
<h3 class="anchored" data-anchor-id="births-and-deaths">Births and deaths</h3>
<ul>
<li>Typically the demographic processes of mosquitoes (births, deaths) occur on a much shorter time scale than the same processes for humans — mosquitoes may live a few weeks whereas humans live for decades.</li>
<li>Depending on the time over which the model will be run to answer the research question, it is common for mosquito births and deaths to be included in a model while human births and deaths are omitted.</li>
<li>To maintain a constant population in a model, we set the birth rates and the death rates to be equal.</li>
<li>In the model we are building in this session, we will ignore human births and deaths and maintain a constant mosquito population.</li>
<li>In the model we are building in this session, all new members of the population are born susceptible to the modelled disease.</li>
</ul>
</section>
<section id="other-modelling-considerations" class="level3">
<h3 class="anchored" data-anchor-id="other-modelling-considerations">Other modelling considerations</h3>
<ul>
<li>Many of the processes affecting the life cycle of mosquitoes are highly climate dependent and so vary seasonally. For the purposes of illustration, we will not include seasonality in our model. <!-- todo: if remove oncho above, need to update this point too --></li>
<li>As we saw when we compared the transmission cycle for onchocerciasis with the transmission cycle of West Nile virus, for some vector-borne diseases vertebrate hosts other than humans are involved. As this adds substantial complexity to the model, in this session we consider only diseases that spread human-vector-human.</li>
<li>While we have assumed a constant probability across the whole population that a bite will result in transmission, in reality this may not be the case due to population heterogeneity.</li>
<li>If a disease is transmitted by multiple mosquito species, the lifespans and other important factors may be different, so may need to be explicitly modelled.</li>
</ul>
<p>
<input type="button" value="Print this page" onclick="window.print()">
</p>
</section>
</section>
<section id="part-2-solutions" class="level2">
<h2 class="anchored" data-anchor-id="part-2-solutions"><strong>Part 2:</strong> Solutions</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><strong>Part 2:</strong> Spoiler alert</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><strong>Part 2:</strong> Solutions for Part 2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>The solutions tab contains solutions for Part 2. <strong>Only click on it if you have tried to complete the exercises yourself and need some help</strong></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<section id="purpose-1" class="level3">
<h3 class="anchored" data-anchor-id="purpose-1">Purpose</h3>
<p>In this part of the session, we will consider the mechanistic process by which vector-borne diseases spread and consider the other elements that are needed in vector-borne disease models.</p>
</section>
<section id="simplified-spread-of-a-mosquito-borne-disease-1" class="level3">
<h3 class="anchored" data-anchor-id="simplified-spread-of-a-mosquito-borne-disease-1">Simplified spread of a mosquito-borne disease</h3>
<p>While there are many different types of vectors, in this and the following part we will cover modelling of diseases that are spread by mosquitoes. Female mosquitoes bite humans to obtain protein from blood for their developing eggs. These bites can transmit infection from mosquito to human or from human to mosquito. The following diagram outlines a simple transmission cycle of a mosquito-borne disease:</p>
<div class="row">
<center>
<img src="vector_borne_cycle_simple.png" alt="Simplified spread of a mosquito-borne disease" style="width:50%">
</center>
</div>
<p>
<br>
</p>
<p>The steps involved in transmission, as indicated on the diagram above are:</p>
<ol type="1">
<li>A susceptible mosquito bites an infectious human.</li>
<li>Infection is successfully transmitted to the mosquito. The pathogen multiplies within the mosquito. The mosquito is now infectious, and capable of transmitting disease.</li>
<li>The infectious mosquito bites a susceptible human.</li>
<li>Infection is successfully transmitted to the human. The pathogen multiplies within the human. The human is now infectious, and capable of transmitting disease.</li>
</ol>
<p>You might notice that in our diagram above both humans and mosquitoes are infectious immediately upon being infected. In reality, it takes time for the infectious load to build in a host before they are capable of transmitting infection. We make this assumption here to simplify the explanation of the transmission process.</p>
</section>
<section id="recovery-from-infection-1" class="level3">
<h3 class="anchored" data-anchor-id="recovery-from-infection-1">Recovery from infection</h3>
<p>For the model that we are building in this session, we will assume that:</p>
<ul>
<li>Infectious humans recover at a rate that is the reciprocal of their infectious period.</li>
<li>Once an infectious human recovers, they are immune for the remainder of their life.</li>
<li>Mosquitoes, once infected, remain infectious for the rest of their life.</li>
</ul>
<p>
<br>
</p>
<p><strong>2.1 Based on the diagram and assumptions above, what compartments would be required to model the human population? Use the subscript H to indicate that these are human compartments.</strong></p>
<p><span style="color: blue"><span class="math inline">\(S_H, I_H, R_H\)</span></span></p>
<p>
<br>
</p>
<p><strong>2.2 Based on the diagram and assumptions above, what compartments would be required to model the mosquito population? Use the subscript M to indicate that these are mosquito compartments.</strong></p>
<p><span style="color: blue"><span class="math inline">\(S_M, I_M\)</span></span></p>
<p>
<br>
</p>
</section>
<section id="human-and-mosquito-populations-interact-through-bites-1" class="level3">
<h3 class="anchored" data-anchor-id="human-and-mosquito-populations-interact-through-bites-1">Human and mosquito populations interact through <span style="color: red">bites</span></h3>
<p>The feature that makes vector-borne disease models different to models for diseases spread by direct contact is that the human and mosquito populations interact through bites. We start with the assumption that each mosquito makes a fixed number of bites per unit time, and we define this as <span class="math inline">\(b\)</span>. We further assume that those bites are uniformly spread across the human population, <span class="math inline">\(N_H\)</span>. It follows that the rate at which a specific human is bitten by a specific mosquito, which we define as <span class="math inline">\(r\)</span>, can be calculated as:</p>
<p><span class="math display">\[r=\frac{b}{N_H}\]</span></p>
<p>This is the number of bites a single human receives from a single mosquito per unit time, and is analogous to ‘contact’ in directly-transmitted disease models.</p>
<p><strong>2.3 What happens to the rate <span class="math inline">\(r\)</span> as the human population increases? What do you think might be the implication for transmission?</strong></p>
<p><span style="color: blue">It reduces as the same number of bites are spread over more people. This makes it less likely that a human will be bitten the two times necessary in the required timeframe in order to continue transmission (i.e.&nbsp;once to be infected by an infectious mosquito and then by a susceptible mosquito to infect them.</span></p>
<p>
<br>
</p>
</section>
<section id="probability-of-successful-transmission-1" class="level3">
<h3 class="anchored" data-anchor-id="probability-of-successful-transmission-1">Probability of successful transmission</h3>
<p>Similar to contacts in the case of directly transmitted (human to human) infections, not all mosquito bites will be of sufficient intensity to transmit infection. For each bite, we assign a probability that the bite is of sufficient intensity to transmit infection (if one host is susceptible and the other infectious), using the following notation:</p>
<ul>
<li><span class="math inline">\(T_{HM}\)</span> is the probability that an infectious mosquito biting a human transmits infection to the human</li>
<li><span class="math inline">\(T_{MH}\)</span> is the probability that an infectious human being bitten by a susceptible mosquito transmits infection to the mosquito</li>
</ul>
<p>We refer to this as the probability of successful transmission.</p>
<p><strong>2.4 Write the expression for the number of bites a single human receives from a single mosquito per unit time that are capable of transmitting infection from mosquito to human.</strong></p>
<p><span style="color: blue"><span class="math inline">\(T_{HM} \times \frac{b}{N_H}\)</span></span></p>
<p>
<br>
</p>
<p><strong>2.5 Write the expression for the number of bites a single human receives from a single mosquito per unit time that are capable of transmitting infection from human to mosquito.</strong></p>
<p><span style="color: blue"><span class="math inline">\(T_{MH} \times \frac{b}{N_H}\)</span></span></p>
<p>
<br>
</p>
</section>
<section id="force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m-1" class="level3">
<h3 class="anchored" data-anchor-id="force-of-infection-on-humans-λ_h-and-on-mosquitoes-λ_m-1">Force of infection on humans <span class="math inline">\((λ_H)\)</span> and on mosquitoes <span class="math inline">\((λ_M)\)</span></h3>
<p>The expressions in 2.4 and 2.5 are for the rate of ‘successful’ bites between a single susceptible human and a single infectious mosquito. The <em>force of infection on humans</em>, <span class="math inline">\(λ_H\)</span>, is the rate at which a susceptible human acquires infection, noting that infection can be acquired from any infectious mosquito.</p>
<p><strong>2.6 Write the expression for the force of infection on humans, <span class="math inline">\(\lambda_H\)</span>.</strong></p>
<p><span style="color: blue"><span class="math inline">\(T_{HM} \times \frac{b}{N_H} \times I_M\)</span></span></p>
<p>
<br>
</p>
<p>Similarly the <em>force of infection on mosquitoes</em>, <span class="math inline">\(λ_M\)</span>, is the rate at which a susceptible mosquito acquires infection. A mosquito can acquire infection from any infectious human.</p>
<p><strong>2.7 Write the expression for the force of infection on mosquitoes, <span class="math inline">\(λ_M\)</span>.</strong></p>
<p><span style="color: blue"><span class="math inline">\(T_{MH} \times \frac{b}{N_H} \times I_H\)</span></span></p>
<p>
<br>
</p>
</section>
<section id="new-infections-per-unit-time-1" class="level3">
<h3 class="anchored" data-anchor-id="new-infections-per-unit-time-1">New infections per unit time</h3>
<p>The force of infection (on humans or mosquitoes) is the rate at which infection is acquired in a single susceptible host. To calculate the rate that new infections occur in the whole human or mosquito population, we have to multiply the force of infection by the population at risk of being infected.</p>
<p><strong>2.8 Using the equation for the force of infection on humans, <span class="math inline">\(λ_H\)</span>, write the expression for the total number of human infections per unit time.</strong></p>
<p><span style="color: blue"><span class="math inline">\(T_{HM} \times \frac{b}{N_H} \times I_M \times S_H\)</span></span></p>
<p>
<br>
</p>
<p><strong>2.9 Using the equation for the force of infection on mosquitoes, <span class="math inline">\(λ_M\)</span>, write the expression for the total number of mosquito infections per unit time.</strong></p>
<p><span style="color: blue"><span class="math inline">\(T_{MH} \times \frac{b}{N_H} \times I_H \times S_M\)</span></span></p>
<p>
<br>
</p>
</section>
<section id="births-and-deaths-1" class="level3">
<h3 class="anchored" data-anchor-id="births-and-deaths-1">Births and deaths</h3>
<ul>
<li>Typically the demographic processes of mosquitoes (births, deaths) occur on a much shorter time scale than the same processes for humans — mosquitoes may live a few weeks whereas humans live for decades.</li>
<li>Depending on the time over which the model will be run to answer the research question, it is common for mosquito births and deaths to be included in a model while human births and deaths are omitted.</li>
<li>To maintain a constant population in a model, we set the birth rates and the death rates to be equal.</li>
<li>In the model we are building in this session, we will ignore human births and deaths and maintain a constant mosquito population.</li>
<li>In the model we are building in this session, all new members of the population are born susceptible to the modelled disease.</li>
</ul>
</section>
<section id="other-modelling-considerations-1" class="level3">
<h3 class="anchored" data-anchor-id="other-modelling-considerations-1">Other modelling considerations</h3>
<ul>
<li>Many of the processes affecting the life cycle of mosquitoes are highly climate dependent and so vary seasonally. For the purposes of illustration, we will not include seasonality in our model.</li>
<li>As we saw when we compared the transmission cycle for onchocerciasis with the transmission cycle of West Nile virus, for some vector-borne diseases vertebrate hosts other than humans are involved. As this adds substantial complexity to the model, in this session we consider only diseases that spread human-vector-human.</li>
<li>While we have assumed a constant probability across the whole population that a bite will result in transmission, in reality this may not be the case due to population heterogeneity. Comparing the force of infection measured in humans to the measured entomological inoculation rate (EIR), which is the average number of infectious bites per human per unit time, can help calibrate models to real data.</li>
</ul>
<p>
<input type="button" value="Print this page" onclick="window.print()">
</p>
</section>
</div>
</div>
</div>
</section>
<section id="part-3-writing-the-model" class="level2">
<h2 class="anchored" data-anchor-id="part-3-writing-the-model"><strong>Part 3:</strong> Writing the model</h2>
<section id="model-diagram" class="level3">
<h3 class="anchored" data-anchor-id="model-diagram">Model Diagram</h3>
<p>Now that we have explored how the human and mosquito populations interact in a vector-borne disease model and made some assumptions around what to include in our first model, we will design an appropriate model structure. Using the model compartments you identified in Part 2, and the inflows and outflows from each compartment required based on the assumptions discussed in Part 2, draw your proposed model structure.</p>
<p><strong>Instructions:</strong> <!-- todo: get rid of the electronic upload of a diagram bits --> 1. You can draw a diagram electronically in a program such as PowerPoint, or you can draw your diagram by hand and take a photo</p>
<ol start="2" type="1">
<li><p>Make sure you label all compartments as well as the inflows and outflows from each compartment.</p></li>
<li><p>Save your diagram in one of the following formats: .jpg, .gif, .png</p></li>
<li><p>Upload your diagram using the Browse… button below</p></li>
<li><p>If you prefer, you can describe your model in words in the space below</p></li>
</ol>
<p><strong>NB: You can replace a file by clicking on the file name and selecting a file with a different name.</strong></p>
</section>
<section id="upload-your-image" class="level3">
<h3 class="anchored" data-anchor-id="upload-your-image">Upload your image</h3>
<p>
<input type="file" id="files" name="files[]" multiple=""> 
</p>
<style>
    input[type="file"] {

     display:block;
    }
    .imageThumb {
     max-height: 600px;
     border: 2px solid;
     margin: 10px 10px 0 0;
     padding: 1px;
     }
</style>
<script type="text/javascript">
    $(document).ready(function() {

     if(window.File && window.FileList && window.FileReader) {
        $("#files").on("change",function(e) {
            var files = e.target.files ,
            filesLength = files.length ;
            for (var i = 0; i < filesLength ; i++) {
                var f = files[i]
                var fileReader = new FileReader();
                fileReader.onload = (function(e) {
                    var file = e.target;
                    $("<span class=\"pip\">" +
            "<img class=\"imageThumb\" src=\"" + e.target.result + "\" title=\"" + file.name + "\"/>" +
            "<br/><span class=\"remove\"><u>Remove image</u></span>" +
            "</span>").insertAfter("#files");
          $(".remove").click(function(){
            $(this).parent(".pip").remove();
          });
                });
               fileReader.readAsDataURL(f);
           }
      });
     } else { alert("Your browser doesn't support to File API") }
    });

</script>
</section>
<section id="alternatively-describe-your-model-structure-here" class="level3">
<h3 class="anchored" data-anchor-id="alternatively-describe-your-model-structure-here">Alternatively, describe your model structure here</h3>
<textarea cols="127" rows="6"></textarea>
<p>
<br>
</p>
</section>
<section id="model-equations" class="level3">
<h3 class="anchored" data-anchor-id="model-equations">Model equations</h3>
<p><strong>3.1 For your model, write in words the inflows and outflows from each compartment.</strong></p>
<textarea cols="127" rows="10"></textarea>
<p>
<br>
</p>
<p><strong>3.2 Convert your description of the model inflows and outflows into the differential equations for your model.</strong></p>
<textarea cols="127" rows="10"></textarea>
<p>
<br>
</p>
<p><strong>3.3 Write the equations for the size of each population in your model.</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
</section>
<section id="basic-reproduction-number" class="level3">
<h3 class="anchored" data-anchor-id="basic-reproduction-number">Basic reproduction number</h3>
<p>The basic reproduction number, <span class="math inline">\(\mathcal{R}_0\)</span>, for a vector-borne disease is the number of secondary infections of the same type (i.e.&nbsp;vector or human) generated by a single infectious vector or human in a totally susceptible population. Let’s start with a single infectious mosquito.</p>
<p>We firstly start with the expected number of humans (in a totally susceptible population) infected by this mosquito over the duration of their infectious period.</p>
<p><strong>3.4 Write down this expression using the information you have developed in Parts 2 and 3 (i.e.&nbsp;number of new infections and the duration of the infectious period). We will denote this as <span class="math inline">\(\mathcal{R}_{HM}\)</span>.</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p>Next we consider the expected number of mosquitoes (in a totally susceptible population) infected by a single human over the duration of their infectious period.</p>
<p><strong>3.5 Write down this expression using the information you have developed in Parts 2 and 3 (i.e.&nbsp;number of new infections and the duration of the infectious period). We will denote this as <span class="math inline">\(\mathcal{R}_{MH}\)</span>.</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p>Since a single mosquito infects <span class="math inline">\(\mathcal{R}_{HM}\)</span> humans, and each of these humans infects <span class="math inline">\(\mathcal{R}_{MH}\)</span> mosquitoes, the number of secondary infections a mosquito generates in mosquitoes is the product of <span class="math inline">\(\mathcal{R}_{HM}\)</span> and <span class="math inline">\(\mathcal{R}_{MH}\)</span>.</p>
<p><strong>3.6 Write down this expression, cancelling terms where possible to simplify the expression.</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p><strong>3.7 What happens to <span class="math inline">\(\mathcal{R}_0\)</span> as the number of mosquitoes increases? Why?</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p><strong>3.8 What happens to <span class="math inline">\(\mathcal{R}_0\)</span> as the number of humans increases? Why?</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p><strong>3.9 Depending on the season, mosquitoes may have a reduced life expectancy. What happens to <span class="math inline">\(\mathcal{R}_0\)</span> as the life expectancy of mosquitoes reduces? Why?</strong></p>
<textarea cols="127" rows="4"></textarea>
<p>
<br>
</p>
<p>
<input type="button" value="Print this page" onclick="window.print()">
</p>
</section>
</section>
<section id="part-3-solutions" class="level2">
<h2 class="anchored" data-anchor-id="part-3-solutions"><strong>Part 3:</strong> Solutions</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><strong>Part 3:</strong> Spoiler alert</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><strong>Part 3:</strong> Solutions for Part 3</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>The solutions tab contains solutions for Part 3. <strong>Only click on it if you have tried to complete the exercises yourself and need some help</strong></p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<section id="model-diagram-1" class="level3">
<h3 class="anchored" data-anchor-id="model-diagram-1">Model Diagram</h3>
<p>Now that we have explored how the human and mosquito populations interact in a vector-borne disease model and made some assumptions around what to include in our first model, we will design an appropriate model structure. Using the model compartments you identified in Part 2, and the inflows and outflows from each compartment required based on the assumptions discussed in Part 2, draw your proposed model structure.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><p>You can draw a diagram electronically in a program such as PowerPoint, or you can draw your diagram by hand and take a photo</p></li>
<li><p>Make sure you label all compartments as well as the inflows and outflows from each compartment.</p></li>
<li><p>Save your diagram in one of the following formats: .jpg, .gif, .png</p></li>
<li><p>Upload your diagram using the Browse… button below</p></li>
<li><p>If you prefer, you can describe your model in words in the space below</p></li>
</ol>
<p><strong>NB: You can replace a file by clicking on the file name and selecting a file with a different name.</strong></p>
</section>
<section id="upload-your-image-1" class="level3">
<h3 class="anchored" data-anchor-id="upload-your-image-1">Upload your image</h3>
<p>
<input type="file" id="files" name="files[]" multiple=""> 
</p>
<style>
    input[type="file"] {

     display:block;
    }
    .imageThumb {
     max-height: 600px;
     border: 2px solid;
     margin: 10px 10px 0 0;
     padding: 1px;
     }
</style>
<script type="text/javascript">
    $(document).ready(function() {

     if(window.File && window.FileList && window.FileReader) {
        $("#files").on("change",function(e) {
            var files = e.target.files ,
            filesLength = files.length ;
            for (var i = 0; i < filesLength ; i++) {
                var f = files[i]
                var fileReader = new FileReader();
                fileReader.onload = (function(e) {
                    var file = e.target;
                    $("<span class=\"pip\">" +
            "<img class=\"imageThumb\" src=\"" + e.target.result + "\" title=\"" + file.name + "\"/>" +
            "<br/><span class=\"remove\"><u>Remove image</u></span>" +
            "</span>").insertAfter("#files");
          $(".remove").click(function(){
            $(this).parent(".pip").remove();
          });
                });
               fileReader.readAsDataURL(f);
           }
      });
     } else { alert("Your browser doesn't support to File API") }
    });

</script>
</section>
<section id="alternatively-describe-your-model-structure-here-1" class="level3">
<h3 class="anchored" data-anchor-id="alternatively-describe-your-model-structure-here-1">Alternatively, describe your model structure here</h3>
<p><span style="color: blue">SIR for humans, SI for mosquitoes. Force of infection on humans from mosquitoes and Force of infection on mosquitoes from humans.</span></p>
<p>
<br>
</p>
</section>
<section id="model-equations-1" class="level3">
<h3 class="anchored" data-anchor-id="model-equations-1">Model equations</h3>
<p><strong>3.1 For your model, write in words the inflows and outflows from each compartment.</strong></p>
<p><span style="color: blue">Change in <span class="math inline">\(S_H=-\)</span> new infections in humans</span><br> <span style="color: blue">Change in <span class="math inline">\(I_H=\)</span> new infections in humans <span class="math inline">\(-\)</span> recoveries in humans</span><br> <span style="color: blue">Change in <span class="math inline">\(R_H=\)</span> recoveries in humans</span><br> <span style="color: blue">Change in <span class="math inline">\(S_M=-\)</span> new infections in mosquitoes + mosquitoes born <span class="math inline">\(-\)</span> susceptible mosquitoes died</span><br> <span style="color: blue">Change in <span class="math inline">\(I_M=\)</span> new infections in mosquitoes <span class="math inline">\(-\)</span> infectious mosquitoes died</span><br></p>
<p>
<br>
</p>
<p><strong>3.2 Convert your description of the model inflows and outflows into the differential equations for your model.</strong></p>
<p><span style="color: blue"><span class="math inline">\(\frac{dS_H}{dt} = - T_{HM} \times \frac{b}{N_H} \times I_M \times S_H\)</span></span><br> <span style="color: blue"><span class="math inline">\(\frac{dI_H}{dt} =   T_{HM} \times \frac{b}{N_H} \times I_M \times S_H - \gamma I_H\)</span></span><br> <span style="color: blue"><span class="math inline">\(\frac{dR_H}{dt} = \gamma I_H\)</span></span><br></p>
<p><span style="color: blue">where <span class="math inline">\(\gamma\)</span> is the reciprocal of the duration of infectiousness</span><br></p>
<p><span style="color: blue"><span class="math inline">\(\frac{dS_M}{dt} = - T_{MH} \times \frac{b}{N_H} \times I_H \times S_M + \mu N_M - \mu S_M\)</span></span><br> <span style="color: blue"><span class="math inline">\(\frac{dI_M}{dt} =   T_{MH} \times \frac{b}{N_H} \times I_H \times S_M - \mu I_M\)</span></span><br></p>
<p><span style="color: blue">where <span class="math inline">\(\mu\)</span> is mosquito birth and death rate</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a very simplified model of the process.</p>
</div>
</div>
<!-- todo: change "mosquito birth rate" throughout to better reflect that this is really the maturation rate into adult females. Or at least discuss. Add a model diagram from a real paper at the end to discuss the differences. -->
<p>
<br>
</p>
<p><strong>3.3 Write the equations for the size of each population in your model.</strong></p>
<p><span style="color: blue"><span class="math inline">\(N_H = S_H + I_H + R_H\)</span></span><br> <span style="color: blue"><span class="math inline">\(N_M = S_M + I_M\)</span></span></p>
<!-- this is a good place to discuss sense checking the equations by adding them to note no change in the human or mosquito population sizes -->
<p>
<br>
</p>
</section>
<section id="basic-reproduction-number-1" class="level3">
<h3 class="anchored" data-anchor-id="basic-reproduction-number-1">Basic reproduction number</h3>
<p>The basic reproduction number, <span class="math inline">\(\mathcal{R}_0\)</span>, for a vector-borne disease is the number of secondary infections of the same type (i.e.&nbsp;vector or human) generated by a single infectious vector or human in a totally susceptible population. Let’s start with a single infectious mosquito.</p>
<p>We firstly start with the expected number of humans (in a totally susceptible population) infected by this mosquito over the duration of their infectious period.</p>
<!-- todo: for all these solutions, possibly first write it out in words so can see the direct translation to the equations. -->
<p><strong>3.4 Write down this expression using the information you have developed in Parts 2 and 3 (i.e.&nbsp;number of new infections and the duration of the infectious period). We will denote this as <span class="math inline">\(\mathcal{R}_{HM}\)</span>.</strong></p>
<p><span style="color: blue"><span class="math inline">\(I_M=1, \frac{S_H}{N_H}\approx 1\)</span></span><br> <span style="color: blue">number of new human infections = <span class="math inline">\(T_{HM} \times \frac{b}{N_H} \times I_M \times S_H\)</span></span><br> <span style="color: blue">duration of the mosquito infectious period = <span class="math inline">\(\frac{1}{\mu}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{HM} = T_{HM} \times \frac{b}{N_H} \times I_M \times S_H \times \frac{1}{\mu}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{HM} = T_{HM} \times b \times I_M \times \frac{S_H}{N_H} \times \frac{1}{\mu}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{HM} = T_{HM} \times b \times 1 \times 1 \times \frac{1}{\mu}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{HM} = b \times T_{HM} \times \frac{1}{\mu}\)</span></span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Focus question
</div>
</div>
<div class="callout-body-container callout-body">
<p>What do you notice about the average infectious period of the mosquito? Why is it that?</p>
</div>
</div>
<p>
<br>
</p>
<p>Next we consider the expected number of mosquitoes (in a totally susceptible population) infected by a single human over the duration of their infectious period.</p>
<p><strong>3.5 Write down this expression using the information you have developed in Parts 2 and 3 (i.e.&nbsp;number of new infections and the duration of the infectious period). We will denote this as <span class="math inline">\(\mathcal{R}_{MH}\)</span>.</strong></p>
<p><span style="color: blue"><span class="math inline">\(I_H=1, S_M\approx N_M\)</span></span><br> <span style="color: blue">number of new mosquito infections = <span class="math inline">\(T_{MH} \times \frac{b}{N_H} \times I_H \times S_M\)</span></span><br> <span style="color: blue">average human infectious period = <span class="math inline">\(\frac{1}{\gamma}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{MH} = T_{MH} \times \frac{b}{N_H} \times I_H \times S_M \times \frac{1}{\gamma}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{MH} = T_{MH} \times \frac{b}{N_H} \times 1 \times N_M \times \frac{1}{\gamma}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{MH} = b \times T_{MH} \times \frac{N_M}{N_H} \times \frac{1}{\gamma}\)</span></span></p>
<p>
<br>
</p>
<p>Since a single mosquito infects <span class="math inline">\(\mathcal{R}_{HM}\)</span> humans, and each of these humans infects <span class="math inline">\(\mathcal{R}_{MH}\)</span> mosquitoes, the number of secondary infections a mosquito generates in mosquitoes is the product of <span class="math inline">\(\mathcal{R}_{HM}\)</span> and <span class="math inline">\(\mathcal{R}_{MH}\)</span>.</p>
<p><strong>3.6 Write down this expression, cancelling terms where possible to simplify the expression.</strong></p>
<p><span style="color: blue"><span class="math inline">\(\mathcal{R}_{HM} \times \mathcal{R}_{MH} = b \times T_{HM} \times \frac{1}{\mu} \times b \times T_{MH} \times \frac{N_M}{N_H} \times \frac{1}{\gamma}\)</span></span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_{HM} \times \mathcal{R}_{MH} = b^2 \times T_{HM} \times T_{MH} \times \frac{N_M}{N_H} \times \frac{1}{\mu \times \gamma}\)</span></span></p>
<p>
<br>
</p>
<p><strong>3.7 What happens to <span class="math inline">\(\mathcal{R}_0\)</span> as the number of mosquitoes increases? Why?</strong></p>
<p><span style="color: blue"><span class="math inline">\(\mathcal{R}_{MH} \times \mathcal{R}_{HM}\)</span> is <span class="math inline">\(\mathcal{R}_0\)</span> for vector borne models</span><br> <span style="color: blue"><span class="math inline">\(\mathcal{R}_0\)</span> increases as <span class="math inline">\(N_M\)</span> increases, because as the susceptible mosquito population is larger, the infectious human will be bitten by more mosquitoes and pass infection to them</span></p>
<p>
<br>
</p>
<p><strong>3.8 What happens to <span class="math inline">\(\mathcal{R}_0\)</span> as the number of humans increases? Why?</strong></p>
<p><span style="color: blue"><span class="math inline">\(\mathcal{R}_0\)</span> decreases, because the fixed number of bites from a mosquito are now spread over a larger population, so each human is bitten less, limiting their ability to pass infection on.</span></p>
<p>
<br>
</p>
<p><strong>3.9 Depending on the season, mosquitoes may have a reduced life expectancy. What happens to <span class="math inline">\(\mathcal{R}_0\)</span> as the life expectancy of mosquitoes reduces? Why?</strong></p>
<p><span style="color: blue"><span class="math inline">\(\mathcal{R}_0\)</span> decreases because mosquitoes have a shorter amount of time over which they are able to bite humans.</span></p>
<p>
<br>
</p>
<!-- todo: Add here some realistic examples of a malaria and a dengue model here, and discuss the differences in assumptions. Ensure you explain the questions those models were also designed to answer. -->
<p>
<input type="button" value="Print this page" onclick="window.print()">
</p>
</section>
</div>
</div>
</div>


</section>
</section>

<section id="contributors">
<h2 class="anchored" data-anchor-id="contributors">Contributors</h2>
<ul>
    <li>Trish Campbell, The University of Melbourne at The Peter Doherty Institute for Infection and Immunity</li>
    </ul>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>For more information or to report issues, please contact <a href="mailto:spectrum-spark@unimelb.edu.au">the consortia project inbox</a>. <br> © July 2025 SPARKLE</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>SPARKLE is funded by the Australian Department of Foreign Affairs and Trade (DFAT)</p>
</div>
  </div>
</footer>




</body></html>