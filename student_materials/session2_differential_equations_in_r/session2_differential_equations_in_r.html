<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Developed by Michael Meehan and Rhondda Jones">
<meta name="author" content="Presented by Michael Lydeamore and Eamon Conway">
<meta name="author" content="July 2022">

<title>Differential Equations in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Differential Equations in R</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1_intro_to_mathematical_modelling/session1_intro_to_mathematical_modelling.html" class="sidebar-item-text sidebar-link">Introduction to Mathematical Modelling</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2_differential_equations_in_r/session2_differential_equations_in_r.html" class="sidebar-item-text sidebar-link active">Differential Equations in R</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3_writing_a_model_to_suit_the_infectious_agent/session3_writing_a_model_to_suit_the_infectious_agent.html" class="sidebar-item-text sidebar-link">Designing a model to suit the pathogen</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4_covid_thailand_seir_model/session4_covid_thailand_seir_model.html" class="sidebar-item-text sidebar-link">Fitting models in R</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session5_fitting_models_in_r/session5_fitting_models_in_r.html" class="sidebar-item-text sidebar-link">Modelling an outbreak - COVID-19 in Thailand</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session7_vector_borne_modelling/session7_vector_borne_modelling.html" class="sidebar-item-text sidebar-link">Vector-borne disease modelling</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session8_vector_borne_modelling_in_r/session8_vector_borne_modelling_in_r.html" class="sidebar-item-text sidebar-link">Vector-borne disease models in R</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session9_modelling_interventions_in_r/session9_modelling_interventions_in_r.html" class="sidebar-item-text sidebar-link">Modelling interventions in R</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#open-a-new-script-file-for-this-session" id="toc-open-a-new-script-file-for-this-session" class="nav-link active" data-scroll-target="#open-a-new-script-file-for-this-session">Open a new script file for this session</a></li>
  <li><a href="#code-summary" id="toc-code-summary" class="nav-link" data-scroll-target="#code-summary">Code summary</a></li>
  <li><a href="#set-working-directory" id="toc-set-working-directory" class="nav-link" data-scroll-target="#set-working-directory">Set working directory</a></li>
  <li><a href="#material" id="toc-material" class="nav-link" data-scroll-target="#material">Material</a></li>
  <li><a href="#part-1-solving-differential-equations" id="toc-part-1-solving-differential-equations" class="nav-link" data-scroll-target="#part-1-solving-differential-equations">Part 1: Solving differential equations</a>
  <ul class="collapse">
  <li><a href="#differential-equations" id="toc-differential-equations" class="nav-link" data-scroll-target="#differential-equations">Differential equations</a></li>
  <li><a href="#simple-example-population-growth" id="toc-simple-example-population-growth" class="nav-link" data-scroll-target="#simple-example-population-growth">Simple example: population growth</a>
  <ul class="collapse">
  <li><a href="#library-loading" id="toc-library-loading" class="nav-link" data-scroll-target="#library-loading">Library loading</a></li>
  <li><a href="#setting-up-the-differential-equation" id="toc-setting-up-the-differential-equation" class="nav-link" data-scroll-target="#setting-up-the-differential-equation">Setting up the differential equation</a></li>
  <li><a href="#plotting-the-solution" id="toc-plotting-the-solution" class="nav-link" data-scroll-target="#plotting-the-solution">Plotting the solution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-2-multi-dimensional-systems" id="toc-part-2-multi-dimensional-systems" class="nav-link" data-scroll-target="#part-2-multi-dimensional-systems">Part 2: Multi-dimensional systems</a>
  <ul class="collapse">
  <li><a href="#exercise-the-sir-epidemic-model" id="toc-exercise-the-sir-epidemic-model" class="nav-link" data-scroll-target="#exercise-the-sir-epidemic-model">Exercise: The SIR epidemic model</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#extension-exercises" id="toc-extension-exercises" class="nav-link" data-scroll-target="#extension-exercises">Extension exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">
<h1 class="title d-none d-lg-block display-7">Differential Equations in R</h1>
<p class="author">Developed by <a href="https://research.jcu.edu.au/portfolio/michael.meehan1/">Michael Meehan</a> and <a href="https://research.jcu.edu.au/portfolio/rhondda.jones/">Rhondda Jones</a></p>
<p class="author">Presented by <a href="https://research.monash.edu/en/persons/michael-lydeamore">Michael Lydeamore</a> and Eamon Conway</p>
<p class="author">July 2022</p>

</header>

<div class="cell">

</div>
<div class="cell" data-layout-align="center">
<style type="text/css">
textarea {
    width: 100%;
}

.line-block {
    line-height: 1.5em;
}

.line-block a {
    font-style: italic;
}
</style>
</div>
<section id="open-a-new-script-file-for-this-session" class="level3">
<h3 class="anchored" data-anchor-id="open-a-new-script-file-for-this-session">Open a new script file for this session</h3>
<p>We have put a file in the <code>./student_materials</code> folder and given it a meaningful name, <code>session2_differential_equations_practical</code>.</p>
</section>
<section id="code-summary" class="level3">
<h3 class="anchored" data-anchor-id="code-summary">Code summary</h3>
<p>It is good practice to write a short description of your code to summarise its purpose for future users. Below is an example of such a description. Open RStudio, create a new file and copy and paste the code chunk below into your editor to start writing your own code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## DIFFERENTIAL EQUATIONS IN R PRACTICAL SESSION##</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A model for COVID-19</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Some R code to numerically solve a set of ordinary differential equations</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and then plot the results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<strong>1.1</strong> What does the <code>#</code> character mean in the R language?
<textarea cols="127" rows="1"></textarea>
</section>
<section id="set-working-directory" class="level3">
<h3 class="anchored" data-anchor-id="set-working-directory">Set working directory</h3>
<p>You must let R know the location of any files you plan to import, so remember to set your working directory. The most reproducible way to do this is to use an RStudio Project, combined with the <code>here</code> package. Projects do a few things:</p>
<ul>
<li>Store project specific settings</li>
<li>Project-specific .Rhistory, .Rprofile and a handful of other files</li>
<li>Add a handy little piece of text on your RStudio icon</li>
<li>Store it’s own history</li>
<li>Set your working directory to the project-specific top-level folder.</li>
</ul>
<p>They come with a file, ending in <code>.Rproj</code>, which you can open directly to open the project in RStudio.</p>
<p><em>Note that RStudio Project are specific to RStudio</em>. If you change editor they won’t work.</p>
<p>To set up an RStudio project, go to File &gt; New Project. Name it something useful. Now, our working directory is set.</p>
<p>If you don’t want to use an RStudio Project (you should), then you can manually set the working directory by going to Session &gt; Set Working Directory &gt; To Source Location</p>
<p>Alternatively, copy and paste the code chunk below into your editor, and edit according to your computer to continue writing your code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Windows</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd('your_path_goes_here')</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"your_path_goes_here"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># we recommend that you put it in '.\student_materials'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mac OSX</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("./workshop")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="material" class="level1">
<h1>Material</h1>
<p>In this session, we will go through some more advanced R programming topics, including how to solve differential equations using the <code>deSolve</code> package.</p>
<p>Part 1 covers:</p>
<ul>
<li>Background on differential equations</li>
<li>Setting up differential equations in <code>deSolve</code></li>
<li>Solving differential equations in <code>deSolve</code></li>
</ul>
<p>Part 2 covers:</p>
<ul>
<li>Systems of differential equations</li>
<li>Solving coupled DEs using <code>deSolve</code></li>
</ul>
<p><em>We recommend to save your text at the end of each part by printing the file.</em></p>
</section>
<section id="part-1-solving-differential-equations" class="level1">
<h1>Part 1: Solving differential equations</h1>
<section id="differential-equations" class="level2">
<h2 class="anchored" data-anchor-id="differential-equations">Differential equations</h2>
<p>Differential equations are equations that describe the rate of change of some quantity (or quantities) with respect to an independent variable, typically time or space. For example, the rate per unit time at which chemical compounds are formed in chemical reactions, or at which heat dissipates from an object can often be described by systems of differential equations.</p>
<p>The package <code>deSolve</code> is used to solve systems of initial value problem differential equations within the R programming language. The package is based on previously developed <code>FORTRAN</code> routines and many <code>deSolve</code> functions are wrappers around existing FORTRAN codes.</p>
<p>As described in the <code>deSolve</code> introductory manual, differential equations are implemented and solved in R through two separate steps: model specification and model application. In the first step, model specification, the user is required to define the model parameters and state variables and implement the derivative function. In the next step, model application, the user specifies a time lattice upon which the solution to the differential equation should be returned and integrates the differential equations using the functions available in the <code>deSolve</code> package.</p>
<p>In this chapter we will implement several examples of systems of differential equations and use the <code>deSolve</code> package in R to solve them. (See <a href="https://cran.r-project.org/web/packages/deSolve/deSolve.pdf"><code>deSolve</code> manual</a>.)</p>
</section>
<section id="simple-example-population-growth" class="level2">
<h2 class="anchored" data-anchor-id="simple-example-population-growth">Simple example: population growth</h2>
<p>To guide you through the model specification and application steps described above, we will start with an easy example: modelling population growth. One of the simplest models of population growth is the Malthusian model which assumes that a population of size <span class="math inline">\(N(t)\)</span> grows at a rate proportional to its current size. That is, the growth rate per unit time of the population size obeys the relation</p>
<p><span class="math display">\[\frac{dN(t)}{dt} \propto N(t)\]</span></p>
<p>(where the symbol <span class="math inline">\(\propto\)</span> means “is proportional to”). In this case, the larger the current population size <span class="math inline">\(N(t)\)</span>, the faster it grows.</p>
<p>We can convert the proportionality relation given above into a standard differential equation by introducing the population growth rate <span class="math inline">\(r\)</span>:</p>
<p><span class="math display">\[\frac{dN(t)}{dt} = rN(t)\]</span></p>
<p>This differential equation is one dimensional, ie it has only one state variable: <span class="math inline">\(N(t)\)</span>; and it has a single parameter: the growth rate <span class="math inline">\(r\)</span>. Note that in this example, and those that follow, we will always include the time dependence of state variables to help distinguish them from model parameters.</p>
<p>In order to fully specify the model mathematically we must provide an initial condition, ie the population size <span class="math inline">\(N\)</span> at time <span class="math inline">\(t=0\)</span>, which we denote as <span class="math inline">\(N(t=0)=N_0\)</span>. Here we take</p>
<p><span class="math display">\[\begin{align}
r &amp;= 2 \\
N_0 &amp;= 1
\end{align}\]</span></p>
<p>Given values for the growth rate <span class="math inline">\(r\)</span> and the initial population size <span class="math inline">\(N_0\)</span> we can now integrate (ie solve) our differential equation to determine the population size <span class="math inline">\(N(t)\)</span> at future times <span class="math inline">\(t&gt;0\)</span>.</p>
<section id="library-loading" class="level3">
<h3 class="anchored" data-anchor-id="library-loading">Library loading</h3>
<p>Before doing anything else, let’s install the <code>deSolve</code> package and then load it into our workspace. We’ll also need the <code>tidyverse</code>, which is a bunch of packages that make working with data a bit easier in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you get an error while trying to load the package, make sure to install it through RStudio.</p>
</section>
<section id="setting-up-the-differential-equation" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-differential-equation">Setting up the differential equation</h3>
<p>The first step in solving a differential equation in <code>deSolve</code> is to specify our model parameters and initialize our state variables</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model parameters and store values in a labelled vector</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="dv">2</span>) <span class="co"># Growth rate</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the initial conditions, define state variables and assign initial values</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>initN <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Start with an initial population size N(0) = 1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> initN) <span class="co"># Specify the state variables and initialize them to their initial values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model parameters, which in this case is just the growth rate <span class="math inline">\(r\)</span>, have been stored in the <em>labelled</em> vector <code>parameters</code>; and the state variables and their initial conditions have been defined in the vector <code>state</code>. Here we have been careful to ensure that the parameter and state variables are stored as vectors with assigned names and values.</p>
<p>Next, we specify the model differential equation (given above) as a user-defined R function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We specify the system of differential equations as a function in R</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we specify a function with three arguments:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. t : time, which is the dependent variable in our case</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. state : a vector of state variables</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. parameters : a vector of parameters (ie fixed variables)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>popmodel_exponentialgrowth <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parameters) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize an environment with the elements of state and parameters as local variables</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parameters)), {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        dNdt <span class="ot">&lt;-</span> r <span class="sc">*</span> N <span class="co"># The model equation</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(<span class="fu">c</span>(dNdt)) <span class="co"># Return the population growth rate dNdt</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the function definition given above we have used the <code>with(as.list(c(state, parameters),{...})</code> statement to create an <em>environment</em> that allows us to access the <code>state</code> and <code>parameter</code> variables directly by name within our function <code>popmodel_exponentialgrowth</code>. If we didn’t use <code>with</code>, then we would have to refer to all of our parameters and states using the name notation, such as <code>parameters['r']</code>.</p>
<p>The user-defined function <code>popmodel_exponentialgrowth</code>, which calculates and returns the rate of change of each of our state variables, is the function that we will pass to <code>ode</code> from <code>deSolve</code> in order to solve the differential equation. However, before we can do this, we first need to specify a time lattice over which we wish our solution to our differential equation to be returned:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with an initial time of t=0 and solve up to t=5 with time increments of 0.01</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the sequence of times defined here by the user only specifies the lattice points at which we require an estimate of the solution, in this case the population size. In general, if the <code>times</code> sequence consists of time points <code>t1</code>, <code>t2</code>, <code>t3</code>, <code>…</code> the <code>ode</code> solver will return an estimate of the solution <code>N(t1)</code>, <code>N(t2)</code>, <code>N(t3)</code>, <code>...</code>. Importantly, the vector times is not related to the time step used by the numerical integration routine adopted by the ode solver in <code>ode</code>.</p>
<p>We now have all of the ingredients we require to solve our simple population growth model and are ready to call the <code>ode</code> integration function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we specify four arguments of the ode function:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. y : the state variables</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. times : the time lattice over which we solve the differential equation</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. func : our differential equation given in terms of our state variables and model parameters</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. parms : our model parameters</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">y =</span> state, <span class="at">times =</span> times, <span class="at">func =</span> popmodel_exponentialgrowth, <span class="at">parms =</span> parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the code above we call the <code>ode</code> function to numerically integrate our differential equation <code>popmodel_exponentialgrowth</code> and store the solution in the <code>deSolve</code> object <code>out</code>. To view the first few lines of output we can type</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     time        N
[1,] 0.00 1.000000
[2,] 0.01 1.020202
[3,] 0.02 1.040812
[4,] 0.03 1.061839
[5,] 0.04 1.083289
[6,] 0.05 1.105173</code></pre>
</div>
</div>
<p>Here we see that the solution <span class="math inline">\(N(t)\)</span> is given at each time point specified in the time lattice times, ie at intervals of <span class="math inline">\(\Delta t=0.01\)</span> from <span class="math inline">\(t=0\)</span> up to <span class="math inline">\(t=10\)</span>. Notice that the first value of the solution <span class="math inline">\(N\)</span> at time <span class="math inline">\(t=0\)</span> is the initial value we specified above, <code>initN = 1</code>.</p>
</section>
<section id="plotting-the-solution" class="level3">
<h3 class="anchored" data-anchor-id="plotting-the-solution">Plotting the solution</h3>
<p><code>ggplot</code> doesn’t know how to deal with <code>deSolve</code> outputs directly, so we have to turn it into a <code>data.frame</code> using <code>as.data.frame</code>. Then, having done that, we can map our x and y axes and plot the solution:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(out), <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>N)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, t"</span>, <span class="at">y=</span><span class="st">"Population size, N(t)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_differential_equations_in_r_files/figure-html/de-growth-visualise-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plotted solution shows a population that grows exponentially with time rapidly increasing in size to &gt;20,000 individuals.</p>
Using the solution provided by the <code>ode()</code> function call and returned in the object <code>out</code>, determine the time interval during which the population size <span class="math inline">\(N\)</span> exceeded 1000.
<textarea cols="127" rows="2"></textarea>
<p>It is important to realize that rounding errors are inevitable during numerical integration and there is no guarantee that the solution generated by the <code>ode</code> function is accurate. Therefore, whenever possible, you should always validate your solution with known analytical results or approximations. Fortunately for our case, an exact analytical solution to the differential equation given above exists:</p>
<p><span class="math display">\[\frac{dN(T)}{dt} = rN(t) \quad \Rightarrow \quad N(t) = N_0 e^{rt}\]</span></p>
<p>where <span class="math inline">\(e\)</span> is Euler’s number (=2.718282…). Given this analytical solution we can check the accuracy of our numerical solution by plotting the two solutions on the same graph:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a coarse time lattice for display purposes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>times_coarse <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the exact solution given the model parameters and initial conditions</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Nexact <span class="ot">&lt;-</span> initN <span class="sc">*</span> <span class="fu">exp</span>(parameters[<span class="st">"r"</span>] <span class="sc">*</span> times_coarse)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>exact_solution <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> times_coarse, Nexact)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(out), <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>N, <span class="at">colour=</span><span class="st">"Numeric"</span>)) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> exact_solution, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>Nexact, <span class="at">colour=</span><span class="st">"Exact"</span>)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, t"</span>, <span class="at">y=</span><span class="st">"Population size, N(t)"</span>, <span class="at">colour=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_differential_equations_in_r_files/figure-html/de-growth-visualise-compare-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above we can see that the numerical solution obtained using the <code>ode</code> function (and its default parameter settings) provides a very accurate approximation of the exact model solution.</p>
Repeat your earlier calculation for the time taken for <span class="math inline">\(N(t)&gt;1000\)</span>, this time using the exact analytical solution for the population size <span class="math inline">\(N(t)\)</span>. Compare your answer with the numerical result.
<textarea cols="127" rows="2"></textarea>
<p>When exact, or even approximate analytical solutions are not available, another way to validate your numerical solution is by decreasing the time step to see if the solution varies substantially. If the solution is stable, eventually you should notice very little difference in the numerical solution as you continually decrease the time step, ie it should converge. This can be adjusted in the ode function using the rtol and atol parameters which set the relative and absolute error tolerances accepted during the integration routine (see <a href="https://cran.r-project.org/web/packages/deSolve/deSolve.pdf"><code>deSolve</code> manual</a>.)</p>
</section>
</section>
</section>
<section id="part-2-multi-dimensional-systems" class="level1">
<h1>Part 2: Multi-dimensional systems</h1>
<section id="exercise-the-sir-epidemic-model" class="level2">
<h2 class="anchored" data-anchor-id="exercise-the-sir-epidemic-model">Exercise: The SIR epidemic model</h2>
<p>To model the spread of infectious diseases it is common to split the population up into three disease states: <span class="math inline">\(S\)</span>, susceptible to infection; <span class="math inline">\(I\)</span>, infected and infectious; <span class="math inline">\(R\)</span>, recovered. During an outbreak the rates of change of each of these three populations can be described using the following system of (coupled) differential equations:</p>
<p><span class="math display">\[\begin{align}
    \frac{dS(t)}{dt}&amp;=-\beta \frac{S(t)}{N}I(t)\\
    \frac{dI(t)}{dt}&amp;=\beta \frac{S(t)}{N}I(t)-\gamma I(t)\\
    \frac{dR(t)}{dt}&amp;=\gamma I(t).
\end{align}\]</span></p>
<p>This system is known as the SIR model of disease transmission and contains two parameters: the infection transmission rate, <span class="math inline">\(\beta\)</span>; and the recovery rate, <span class="math inline">\(\gamma\)</span>.</p>
<p>Taking parameter values</p>
<p><span class="math display">\[\begin{align}
    \beta&amp;=5\\
    \gamma&amp;=1
\end{align}\]</span></p>
<p>and initial conditions</p>
<p><span class="math display">\[\begin{align}
    S_0 &amp;= 199\\
    I_0 &amp;= 1\\
    R_0 &amp;= 0
\end{align}\]</span></p>
<p>solve the SIR model following the same steps described above for the predator-prey model. Plot your solution to generate the following figure:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_differential_equations_in_r_files/figure-html/sir-model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<ol type="1">
<li>Describe the epidemic trajectory for the parameter values provided: When did the epidemic peak occur? What was the final size (total number of people infected) of the epidemic outbreak?
<textarea cols="127" rows="2"></textarea></li>
<li>The basic reproduction number <span class="math inline">\(R_0\)</span> is defined as the average number of new cases generated by a typical infectious individual when introduced into a totally susceptible population. For the SIR model described above, the basic reproduction number is <span class="math inline">\(R_0 = \beta S_0 / \gamma\)</span>. Calculate the <span class="math inline">\(R_0\)</span> for the parameter values given above.
<textarea cols="127" rows="2"></textarea></li>
<li>By considering a range of values for the transmission rate <span class="math inline">\(\beta\)</span>, describe how the epidemic trajectory varies as a function of <span class="math inline">\(R_0\)</span>. In particular, what happens when <span class="math inline">\(R_0&lt;1\)</span>?
<textarea cols="127" rows="2"></textarea></li>
<li>The quantity <span class="math inline">\(R_e(t) = \beta S(t)/\gamma\)</span> is called the effective reproduction number and it accounts for the depletion of susceptibles as the infection sweeps through the population. Review your previous results and record the value of <span class="math inline">\(S(t_{peak})\)</span> where <span class="math inline">\(t_{peak}\)</span> is the time at which the infectious population reaches its maximum, ie the epidemic peak. Using these values of <span class="math inline">\(S(t_{peak})\)</span> calculate <span class="math inline">\(R_e(t_{peak})\)</span> and report any patterns that you observe.
<textarea cols="127" rows="2"></textarea></li>
<li>If the reproduction number gives the multiplicative growth rate in the number of infectious individuals can you explain your observations from the previous two questions.
<textarea cols="127" rows="2"></textarea></li>
</ol>
</section>
<section id="section" class="level1">
<h1></h1>
<p><input type="button" value="Print this page" onclick="window.print()"></p>
</section>
<section id="extension-exercises" class="level1">
<h1>Extension exercises</h1>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Logistic population growth</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Lotka-Volttera Model</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>From the figures we have generated so far you might have noticed that the Malthusian growth model is probably not appropriate in most settings (Why? Try solving the model over a longer time horizon to find out). A more realistic model of population growth is given by the logistic growth model where the growth rate <span class="math inline">\(r\)</span> now varies as a function of the population size:</p>
<p><span class="math display">\[ r \rightarrow r\left(1 - \frac{N(t)}{k}\right)\]</span></p>
<p>such that the rate of change in population size <span class="math inline">\(dN(t)/dt\)</span> becomes</p>
<p><span class="math display">\[\frac{dN(t)}{dt} = rN(t) \left(1-\frac{N(t)}{K}\right).\]</span></p>
<p>Notice we have now introduced a new parameter in our model: the carrying capacity, <span class="math inline">\(K\)</span>.</p>
<p>Your task is to adapt the code sequence above which we used to solve the Malthusian (exponential) growth model to solve the logistic growth model. You may take the following values for the model parameters and state variables:</p>
<p><span class="math display">\[\begin{align}
r &amp;= 0.15 \\
K &amp;= 1000 \\
N_0 &amp;= 1
\end{align}\]</span></p>
<p>You will have to first determine what the model state variables and parameters are and then write your own function to evaluate the logistic function according to the above equations.</p>
<section id="exercises-1" class="level3">
<h3 class="anchored" data-anchor-id="exercises-1">Exercises</h3>
<ol type="1">
<li>How does the logistic growth model vary from the exponential model?
<textarea cols="127" rows="2"></textarea></li>
<li>How does varying the parameter <span class="math inline">\(K\)</span> vary the solution?
<textarea cols="127" rows="2"></textarea></li>
<li>What happens if you change the initial conditions?
<textarea cols="127" rows="2"></textarea></li>
</ol>
<p>Once again, an exact solution to our differential equation is available - it is given by</p>
<p><span class="math display">\[N(t) = \frac{K}{1+\left(\frac{K}{N_0}-1\right)e^{-rt}}\]</span></p>
<p>Using this exact solution, check the accuracy of your numerical solution. Your answer should look something like the figure below:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_differential_equations_in_r_files/figure-html/logistic-growth-de-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Often we are interested in dynamical systems that are described in terms of several state variables <span class="math inline">\((x1(t),x2(t),…,xn(t))\)</span>. For example, in chemical reactions we may want to track the concentrations of several reactants and products through time, or in ecological studies the population sizes of various species. In these cases we expect a system of differential equations, often one for each state variable:</p>
<p><span class="math display">\[\begin{align}
    \frac{dx_1 (t)}{dt}&amp;=f_1 (x_1,x_2,,…,x_n,t)\\
    \frac{dx_2 (t)}{dt}&amp;=f_2 (x_1,x_2,…,x_n,t)\\
    \vdots \\
    \frac{dx_n (t)}{dt}&amp;=f_n (x_1,x_2,…,x_n,t).
\end{align}\]</span></p>
<p>On the left we have the rate of change of each state variable <span class="math inline">\(x_i(t)\)</span> and on the right we have a function <span class="math inline">\(f_i\)</span> describing that state’s rate of change. Notice that in the general case, each of the rate of change functions <span class="math inline">\(f_i≡fi(x_1,x_2,...,x_n,t)\)</span> is a function of the other state variables in the system, ie the derivative of <span class="math inline">\(x_i\)</span> may (most likely) depend on the current values of the remaining state variables, <span class="math inline">\(x_j\)</span>. If this is the case we say that our system of differential equations is coupled.</p>
<p>Let us look at a specific example of a coupled set of differential equations. Consider a simple model of two interacting animal populations first described by Lotka (and later by Volterra). One species is the prey whilst the other is the predator. We shall denote their population sizes at time as <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span> respectively.</p>
<center>
<p><img src="predator_prey_image.PNG" class="img-fluid"></p>
</center>
<p>In the Lotka-Volterra model the growth rates of the two populations are given by the following system of differential equations:</p>
<p><span class="math display">\[\begin{align}
    \frac{dx(t)}{dt}&amp;=\alpha x(t)-\beta x(t)y(t),\\        
    \frac{dy(t)}{dt}&amp;=\delta x(t)y(t)- \gamma y(t).
\end{align}\]</span></p>
<p>In the system above, <span class="math inline">\(\alpha\)</span> is the growth rate of the prey population; <span class="math inline">\(\beta\)</span> is the predation rate; δ is the growth rate of the predator population <span class="math inline">\(\delta\)</span> and; <span class="math inline">\(\gamma\)</span> is the death rate of the predator population. Note that the two animal populations interact through the predation term <span class="math inline">\(\beta x(t)y(t)\)</span>.</p>
<p>To complete the description of our model we supply initial conditions for the predator and prey populations which we denote <span class="math inline">\(x_0\)</span> and <span class="math inline">\(y_0\)</span> respectively. In particular we take for parameter values and initial conditions: <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=2\)</span>, <span class="math inline">\(\delta=1\)</span> and <span class="math inline">\(\gamma=1\)</span>; <span class="math inline">\(x_0=2\)</span> and <span class="math inline">\(y_0=0.5\)</span>.</p>
<p>The below code blocks provide parameters and initial conditions for the system:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model parameters and store values in a labelled vector</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="dv">1</span>, <span class="co"># prey growth rate</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta =</span> <span class="dv">2</span>, <span class="co"># predation rate</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta =</span> <span class="dv">1</span>, <span class="co"># predator growth rate</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma =</span> <span class="dv">1</span> <span class="co"># predator death/removal rate</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the initial conditions</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>initx <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Initial prey population size</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>inity <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># Initial predator population size</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the state variables and assign initial values</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">x =</span> initx, <span class="at">y =</span> inity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Your task is to solve the differential equation over the following time lattice:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the initial and final times of the solution vector</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tinit <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Initial time</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tfinal <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># Final time</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>step_size <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Time increment</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>times <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> tinit, <span class="at">to =</span> tfinal, <span class="at">by =</span> <span class="fl">0.1</span>) <span class="co"># Time vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You need to create the function that evaluates the differential equation and create the following plot:</p>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="session2_differential_equations_in_r_files/figure-html/predator-prey-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>